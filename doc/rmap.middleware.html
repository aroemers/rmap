<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>rmap.middleware documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Rmap 0.5.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rmap</span></div></div></li><li class="depth-2 branch"><a href="rmap.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 current"><a href="rmap.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="rmap.middleware.default.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>default</span></div></a></li><li class="depth-3 branch"><a href="rmap.middleware.examples.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-3 branch"><a href="rmap.middleware.parallel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parallel</span></div></a></li><li class="depth-3"><a href="rmap.middleware.sharing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sharing</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="rmap.middleware.html#var-*current-map*"><div class="inner"><span>*current-map*</span></div></a></li><li class="depth-1"><a href="rmap.middleware.html#var-*current-middleware*"><div class="inner"><span>*current-middleware*</span></div></a></li><li class="depth-1"><a href="rmap.middleware.html#var-latest-data"><div class="inner"><span>latest-data</span></div></a></li><li class="depth-1"><a href="rmap.middleware.html#var-Middleware"><div class="inner"><span>Middleware</span></div></a></li><li class="depth-2 branch"><a href="rmap.middleware.html#var-assoc"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>assoc</span></div></a></li><li class="depth-2 branch"><a href="rmap.middleware.html#var-assoc-lazy"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>assoc-lazy</span></div></a></li><li class="depth-2 branch"><a href="rmap.middleware.html#var-dissoc"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dissoc</span></div></a></li><li class="depth-2 branch"><a href="rmap.middleware.html#var-info"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>info</span></div></a></li><li class="depth-2"><a href="rmap.middleware.html#var-request"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>request</span></div></a></li><li class="depth-1"><a href="rmap.middleware.html#var-update-data"><div class="inner"><span>update-data</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">rmap.middleware</h2><div class="doc"><pre class="plaintext">This namespace contains the protocol that must be implemented by
middlewares, and helper functions for inside those middleware
implementations.

Middleware can store and retrieve data in the recursive map. This
data is persistent, meaning storing data in one instance does not
affect the data in another instance. A new instance, due to an assoc
or dissoc, does have the data of its ascendent at the time of the
assoc/dissoc. Middleware has only access to its own data, using the
`latest-data` and `update-data` functions. If required, middleware
can access the recursive map it is applied to, by reading
`*current-map*`.

Middleware can either be dynamic or non-dynamic. Dynamic middleware
means that by its nature it can be added and removed to/from a
recursive map, without causing consistency problems. Non-dynamic
middleware must be added while creating a recursive map.

Note that some middlewares need to respect the
`rmap.internals/*unrealized*` binding.</pre></div><div class="public anchor" id="var-*current-map*"><h3>*current-map*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">When executing a middleware, this is bound to the
recursive map it is applied to.</pre></div></div><div class="public anchor" id="var-*current-middleware*"><h3>*current-middleware*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">When executing a middleware, this is bound to its name.
This is used for middleware data functions `latest-data`
and `update-data`.</pre></div></div><div class="public anchor" id="var-latest-data"><h3>latest-data</h3><div class="usage"><code>(latest-data)</code></div><div class="doc"><pre class="plaintext">Returns the latest middleware data. For use inside middleware.
</pre></div></div><div class="public anchor" id="var-Middleware"><h3>Middleware</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">The protocol for middleware implementations.
</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-assoc"><h3>assoc</h3><div class="usage"><code>(assoc this key val)</code></div><div class="doc"><pre class="plaintext">This function is called whenever a non-lazy value has just been
added to the recursive map. Note that this assoc has resulted in a
new instance.</pre></div></div><div class="public anchor" id="var-assoc-lazy"><h3>assoc-lazy</h3><div class="usage"><code>(assoc-lazy this key)</code></div><div class="doc"><pre class="plaintext">This function is called whenever a lazy form has just been added
to the recursive map. Note that this assoc-lazy has resulted in a
new instance.</pre></div></div><div class="public anchor" id="var-dissoc"><h3>dissoc</h3><div class="usage"><code>(dissoc this key)</code></div><div class="doc"><pre class="plaintext">This action is used whenever an entry has just been removed from
the recursive map. Note that this removal resulted in a new
 instance.</pre></div></div><div class="public anchor" id="var-info"><h3>info</h3><div class="usage"><code>(info this)</code></div><div class="doc"><pre class="plaintext">This should return a map with keys :name and :dynamic? Its values
are the name of the middleware, and a boolean indicating whether
the middleware is dynamic, respectively.</pre></div></div><div class="public anchor" id="var-request"><h3>request</h3><div class="usage"><code>(request this key cont)</code></div><div class="doc"><pre class="plaintext">This function is called whenever an entry in the recursive map is
requested. This action should either return a value, or the result
of calling the continuation.</pre></div></div></div></div></div><div class="public anchor" id="var-update-data"><h3>update-data</h3><div class="usage"><code>(update-data f &amp; args)</code></div><div class="doc"><pre class="plaintext">Updates the middleware data by applying function `f` on the latest
data, and the optional `args`. For use inside middleware.</pre></div></div></div></body></html>